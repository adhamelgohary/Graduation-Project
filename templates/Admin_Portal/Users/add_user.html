{% extends "Admin_Portal/base.html" %}

{% block title %}Add New User{% endblock %}

{% block nav_users %}active{% endblock %}

{% block header_title %}<i class="fas fa-user-plus"></i> Add New User{% endblock %}

{% block extra_css %}
<style>
    .user-type-section {
        display: none;
    }
    .active-section {
        display: block;
    }
</style>
{% endblock %}

{% block content %}
<div class="container">
    <form method="POST" action="{{ url_for('admin_users.add_user') }}">
        <div class="profile-section">
            <h2>User Type Selection</h2>
            <select id="user_type" name="user_type" class="form-control" required>
                <option value="">Select User Type</option>
                <option value="admin">Admin</option>
                <option value="doctor">Doctor</option>
                <option value="patient">Patient</option>
            </select>
        </div>

        <div class="profile-section user-type-section" id="common-details">
            <h2>Common User Details</h2>
            <div class="form-group">
                <label>Username</label>
                <input type="text" name="username" required class="form-control">
            </div>
            <div class="form-group">
                <label>Email</label>
                <input type="email" name="email" required class="form-control">
            </div>
            <div class="form-group">
                <label>Password</label>
                <input type="password" name="password" required class="form-control">
            </div>
            <div class="form-group">
                <label>First Name</label>
                <input type="text" name="first_name" required class="form-control">
            </div>
            <div class="form-group">
                <label>Last Name</label>
                <input type="text" name="last_name" required class="form-control">
            </div>
            <div class="form-group">
                <label>Phone</label>
                <input type="tel" name="phone" class="form-control">
            </div>
            <div class="form-group">
                <label>Country</label>
                <input type="text" name="country" value="United States" class="form-control">
            </div>
            <div class="form-group">
                <label>Account Status</label>
                <select name="account_status" class="form-control">
                    <option value="active">Active</option>
                    <option value="pending">Pending</option>
                    <option value="inactive">Inactive</option>
                </select>
            </div>
        </div>

        <div class="profile-section user-type-section" id="doctor-details">
            <h2>Doctor Details</h2>
            <div class="form-group">
                <label>Specialization</label>
                <input type="text" name="specialization" class="form-control">
            </div>
            <div class="form-group">
                <label>License Number</label>
                <input type="text" name="license_number" class="form-control">
            </div>
            <div class="form-group">
                <label>License State</label>
                <input type="text" name="license_state" class="form-control">
            </div>
            <div class="form-group">
                <label>License Expiration</label>
                <input type="date" name="license_expiration" class="form-control">
            </div>
            <div class="form-group">
                <label>Accepting New Patients</label>
                <select name="accepting_new_patients" class="form-control">
                    <option value="1">Yes</option>
                    <option value="0">No</option>
                </select>
            </div>
            <div class="form-group">
                <label>Clinic Address</label>
                <textarea name="clinic_address" class="form-control"></textarea>
            </div>
            <div class="form-group">
                <label>Education</label>
                <input type="text" name="education" class="form-control">
            </div>
            <div class="form-group">
                <label>Certifications</label>
                <input type="text" name="certifications" class="form-control">
            </div>
        </div>

        <div class="profile-section user-type-section" id="patient-details">
            <h2>Patient Details</h2>
            <div class="form-group">
                <label>Date of Birth</label>
                <input type="date" name="date_of_birth" class="form-control">
            </div>
            <div class="form-group">
                <label>Gender</label>
                <select name="gender" class="form-control">
                    <option value="">Select Gender</option>
                    <option value="male">Male</option>
                    <option value="female">Female</option>
                    <option value="other">Other</option>
                </select>
            </div>
            <div class="form-group">
                <label>Blood Type</label>
                <select name="blood_type" class="form-control">
                    <option value="">Select Blood Type</option>
                    <option value="A+">A+</option>
                    <option value="A-">A-</option>
                    <option value="B+">B+</option>
                    <option value="B-">B-</option>
                    <option value="AB+">AB+</option>
                    <option value="AB-">AB-</option>
                    <option value="O+">O+</option>
                    <option value="O-">O-</option>
                </select>
            </div>
        </div>

        <button type="submit" class="btn btn-primary">Create User</button>
    </form>
</div>
{% endblock %}

{% block scripts %}
<script>
    document.getElementById('user_type').addEventListener('change', function() {
        // Hide all type-specific sections
        document.getElementById('common-details').classList.add('active-section');
        document.getElementById('doctor-details').classList.remove('active-section');
        document.getElementById('patient-details').classList.remove('active-section');

        // Show appropriate section based on user type
        if (this.value === 'doctor') {
            document.getElementById('doctor-details').classList.add('active-section');
        } else if (this.value === 'patient') {
            document.getElementById('patient-details').classList.add('active-section');
        }
    });
</script>
{% endblock %}